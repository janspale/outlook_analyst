# Outlook Mail Analytics Dashboard

A lightweight project for analyzing an Outlook mailbox (incoming + outgoing emails) and visualizing activity in an interactive Streamlit dashboard.

The project:
1. pulls email metadata from desktop Outlook (Windows, Classic Outlook),
2. aggregates counts per day and per week,
3. serves an interactive web dashboard to explore trends, weekly rhythm, and spikes.

> ⚠️ The project does **not** read or store email content (subject/body). It only uses timestamps and direction (incoming/outgoing).

---

## Features

- **Daily email counts** (incoming/outgoing)
- **Weekly email counts**
- **Heatmap: weekday × hour**
- **KPI summary cards** (total, incoming/outgoing, ratio)
- Date-range and direction filters

---

## Requirements

### Data extraction (Outlook COM)
- Windows
- Desktop **Classic Outlook** (not “New Outlook”)
- A signed‑in Outlook profile
- Python 3.10+ (tested on 3.11)
- Packages:
  - `pywin32`
  - `pandas`
  - `matplotlib` *(only for local plots in the analyst script)*

### Dashboard
- Any OS
- Python 3.10+
- Packages:
  - `streamlit`
  - `plotly`
  - `pandas`

---

## Installation

Recommended via a virtual environment:

```powershell
python -m venv .venv
.\.venv\Scripts ctivate
python -m pip install --upgrade pip
pip install -r requirements.txt
```

If you don’t have a `requirements.txt`, install directly:

```powershell
pip install pywin32 pandas matplotlib streamlit plotly
```

---

## 1) Extract data from Outlook (Windows)

Script: `outlook_analyst.py`

Run:

```powershell
python outlook_analyst.py
```

Outputs (CSV):

- `mail_counts_per_day.csv`
- `mail_counts_per_week.csv`
- `mail_raw.csv` *(per‑message timestamps used for the heatmap)*

> If you get empty outputs, check Outlook’s “Mail to keep offline” setting. COM sees only locally cached emails.

---

## 2) Run the dashboard

Script: `dashboard.py`

```powershell
streamlit run dashboard.py
```

The app will be available at:

```
http://localhost:8501
```

---

## Repository layout (example)

```
.
├─ outlook_analyst.py         # Outlook COM extraction + aggregation
├─ dashboard.py               # Streamlit dashboard
├─ mail_counts_per_day.csv    # generated by analyst script
├─ mail_counts_per_week.csv   # generated by analyst script
├─ mail_raw.csv               # generated by analyst script
├─ requirements.txt
└─ README.md
```

---

## Sharing / Deployment

### Streamlit Community Cloud
1. The repository must be on GitHub (public or private).
2. In Streamlit Cloud, create a new app pointing to `dashboard.py`.
3. The app will read CSVs from the repo (or from another storage you configure).

> Recommendation: if you share publicly, avoid committing `mail_raw.csv` unless you are comfortable sharing timestamp‑level metadata.

### Share on a local network (LAN/VPN)
Run Streamlit so it listens on all interfaces:

```powershell
streamlit run dashboard.py --server.address 0.0.0.0 --server.port 8501
```

Then open:

```
http://<your_IP>:8501
```

---

## Privacy & Security

By default, the project stores only:
- message direction (incoming/outgoing)
- received/sent timestamps

It does **not** store:
- subject lines
- message bodies
- addresses
- attachments

For extra caution:
- don’t commit `mail_raw.csv` to a public repo,
- share only aggregated outputs (`per_day`, `per_week`).

---

## Troubleshooting

### `ModuleNotFoundError: No module named 'win32com'`
Install pywin32 into the same Python you use to run the script:

```powershell
python -m pip install pywin32
```

### COM errors / account pop‑ups
- make sure you’re using **Classic Outlook**
- Outlook must be fully started and signed in
- remove dead accounts from Outlook profiles and Windows Credential Manager

### Empty data
- Outlook COM sees only locally cached mail (OST).  
  Set “Mail to keep offline” to a longer period or “All”.

---

## License

MIT (or replace with your preferred license)
